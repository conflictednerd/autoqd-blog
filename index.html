<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners -->
  <meta name="description" content="AutoQD: Automatic Discovery of Diverse Behaviors with Quality-Diversity Optimization. A theoretically grounded approach to automatically generate behavioral descriptors for QD algorithms using occupancy measures and random Fourier features.">
  <meta property="og:title" content="AutoQD: Automatic Discovery of Diverse Behaviors with Quality-Diversity Optimization"/>
  <meta property="og:description" content="Automatically discovering diverse, high-performing policies without hand-crafted behavioral descriptors using occupancy measures and MMD embeddings"/>
  <meta property="og:url" content="https://conflictednerd.github.io/autoqd-blog">
  <meta property="og:image" content="https://conflictednerd.github.io/autoqd-blog/static/images/main.svg">
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>

  <meta name="twitter:title" content="AutoQD: Automatic Discovery of Diverse Behaviors">
  <meta name="twitter:description" content="Automatically discovering diverse, high-performing policies without hand-crafted behavioral descriptors">
  <meta name="twitter:image" content="https://conflictednerd.github.io/autoqd-blog/static/images/main.svg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="keywords" content="Quality-Diversity, Reinforcement Learning, Occupancy Measures, Behavioral Descriptors, Diversity, Random Fourier Features, MMD">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>AutoQD: Automatic Discovery of Diverse Behaviors with Quality-Diversity Optimization</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.png">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

<link rel="stylesheet" href="static/css/bulma.min.css">
<link rel="stylesheet" href="static/css/bulma-carousel.min.css">
<link rel="stylesheet" href="static/css/bulma-slider.min.css">
<!-- <link rel="stylesheet" href="static/css/fontawesome.all.min.css"> -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
<link rel="stylesheet" href="static/css/index.css">

<!-- MathJax Configuration -->
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    }
  };
</script>

<!-- Load MathJax (only once, with correct URL) -->
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>

  <style>
    .key-insight {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 1rem;
      margin: 1.5rem 0;
      border-radius: 4px;
    }
    .math-display {
      text-align: center;
      margin: 1.5rem 0;
      padding: 1rem;
      background: #f8f9fa;
      border-radius: 4px;
      border: 1px solid #e9ecef;
    }
    .section {
      padding: 3rem 1.5rem;
    }
    .hero.is-small .hero-body {
      padding: 2rem 1.5rem;
    }
    img {
      border-radius: 6px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .content h3 {
      margin-top: 2rem;
      color: #363636;
    }
    .subtitle {
      margin-top: 1rem !important;
    }
  </style>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">AutoQD: Automatic Discovery of Diverse Behaviors with Quality-Diversity Optimization</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://conflictednerd.github.io/" target="_blank">Saeed Hedayatian</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://stefanosnikolaidis.net/" target="_blank">Stefanos Nikolaidis</a><sup>1</sup></span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of Southern California</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- Arxiv PDF link -->
              <span class="link-block">
                <a href="TODO_ARXIV_URL" target="_blank" class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                  <i class="fas fa-file-pdf"></i>
                </span>
                <span>Paper</span>
              </a>
              </span>

              <!-- Github link -->
              <span class="link-block">
                <a href="TODO_GITHUB_URL" target="_blank" class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                  <i class="fab fa-github"></i>
                </span>
                <span>Code</span>
              </a>
              </span>

              <!-- ArXiv abstract Link -->
              <span class="link-block">
                <a href="TODO_ARXIV_ABSTRACT_URL" target="_blank" class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                  <i class="ai ai-arxiv"></i>
                </span>
                <span>arXiv</span>
              </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Teaser figure -->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="static/images/main.svg" alt="AutoQD Overview" style="width: 100%;"/>
      <h2 class="subtitle has-text-centered">
        AutoQD automatically discovers behavioral descriptors by embedding policy occupancy measures, enabling Quality-Diversity optimization without hand-crafted features.
      </h2>
    </div>
  </div>
</section>

<!-- Abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
          Quality-Diversity (QD) algorithms have shown remarkable success in discovering diverse, high-performing solutions, but rely heavily on hand-crafted behavioral descriptors that constrain exploration to predefined notions of diversity. Leveraging the equivalence between policies and occupancy measures, we present a theoretically grounded approach to automatically generate behavioral descriptors by embedding the occupancy measures of policies in Markov Decision Processes. Our method, AutoQD, leverages random Fourier features to approximate the Maximum Mean Discrepancy (MMD) between policy occupancy measures, creating embeddings whose distances reflect meaningful behavioral differences. A low-dimensional projection of these embeddings that captures the most behaviorally significant dimensions is then used as behavioral descriptors for off-the-shelf QD methods. We prove that our embeddings converge to true MMD distances between occupancy measures as the number of sampled trajectories and embedding dimensions increase. Through experiments in multiple continuous control tasks we demonstrate AutoQDâ€™s ability in discovering diverse policies without predefined behavioral descriptors, presenting a well-motivated alternative to prior methods in unsupervised Reinforcement Learning and QD optimization. Our approach opens new possibilities for open-ended learning and automated behavior discovery in sequential decision making settings without requiring domain-specific knowledge.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Key Insight and Method -->
<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3">Method</h2>
    
    <div class="key-insight">
      <h4 class="title is-5">ðŸ’¡ Key Insight</h4>
      <p><strong>Occupancy measures can be embedded to reflect behavioral similarity.</strong> We embed occupancy measures into a finite-dimensional space where distances approximate Maximum Mean Discrepancy between policies, providing behavioral descriptors for Quality-Diversity optimization.</p>
    </div>

    <div class="content">
      <h3 class="title is-4">Policy Embedding via Random Fourier Features</h3>
      <p>For a policy $\pi$, its occupancy measure $\rho^{\pi}$ captures the expected discounted visitation frequency of state-action pairs:</p>
      
      <div class="math-display">
        $$\rho^{\pi}(\mathbf{s}, \mathbf{a}) = (1 - \gamma) \sum_{t=0}^{\infty} \gamma^t P(S_t = \mathbf{s}, A_t = \mathbf{a} | \pi)$$
      </div>

      <p>We embed policies into a finite-dimensional space using random Fourier features of the state-action pairs that they visit $\phi(\mathbf{s}, \mathbf{a})$:</p>
      
      <div class="math-display">
        $$\phi(\mathbf{s}, \mathbf{a}) = \sqrt{\frac{2}{D}} \left[\cos(\mathbf{w}_1^T[\mathbf{s}; \mathbf{a}] + \mathbf{b}_1), \ldots, \cos(\mathbf{w}_D^T[\mathbf{s}; \mathbf{a}] + \mathbf{b}_D)\right]$$
      </div>

      <p>where $\mathbf{w}_i \sim \mathcal{N}(0, \sigma^{-2}I)$ and $\mathbf{b}_i \sim U(0, 2\pi)$. The policy embedding is computed using $n$ rollouts of the policy as:</p>
      
      <div class="math-display">
        $$\psi^{\pi} = \frac{1}{n} \sum_{j=1}^{n} (1-\gamma) \sum_{t=0}^{T} \gamma^t \phi(\mathbf{s}_t^j, \mathbf{a}_t^j)$$
      </div>

      <h3 class="title is-4">MMD Distance Approximation</h3>
      <p>The $\ell_2$ distance between embeddings approximates behavioral differences as measured by Maximum Mean Discrepancy:</p>
      
      <div class="math-display">
        $\|\psi^{\pi_1} - \psi^{\pi_2}\| \approx \text{MMD}(\rho^{\pi_1}, \rho^{\pi_2})$
      </div>
    </div>
  </div>
</section>

<!-- Figure 2: MMD Approximation -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-three-quarters">
          <img src="static/images/embedding.svg" alt="Policy Embedding Distance Approximation" style="width: 100%; max-width: 1000px; display: block; margin: 0 auto;"/>
          <h2 class="subtitle has-text-centered">
            <strong>Figure 2:</strong> Policy embedding via random Fourier features. The $\ell_2$ distance between policy embeddings approximates the Maximum Mean Discrepancy between their occupancy measures, providing a theoretically grounded measure of behavioral similarity.
          </h2>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="content">
      <h3 class="title is-4">Behavioral Descriptor Generation</h3>
      <p>We use calibrated weighted PCA to project high-dimensional embeddings to behavioral descriptors:</p>
      
      <div class="math-display">
        $$\text{desc}(\pi) = \mathbf{A}\psi^{\pi} + \mathbf{b}$$
      </div>

      <p>where $\mathbf{A}$ and $\mathbf{b}$ are learned through weighted PCA that emphasizes high-performing policies, followed by calibration to ensure compatibility with QD archives.</p>
    </div>
  </div>
</section>

<!-- Theoretical Guarantee -->
<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3">Theoretical Guarantee</h2>
    <div class="content">
      <p><strong>Theorem (MMD Approximation):</strong> For any two policies $\pi_1, \pi_2$ with embeddings $\phi_1, \phi_2$ estimated from $n$ samples each using $D$-dimensional random Fourier features:</p>
      
      <div class="math-display">
        $$\Pr\left[\left|\|\phi_1 - \phi_2\|_2 - \text{MMD}(\rho_1, \rho_2)\right| \geq \frac{3}{4}\epsilon\right] \leq 2e^{-nc\epsilon^2} + O\left(\frac{1}{\epsilon^2}\exp\left(-\frac{D\epsilon^2}{64(d+2)}\right)\right) + 6e^{-\frac{n\epsilon^2}{8}}$$
      </div>

      <p>This theorem guarantees that our embeddings converge to true MMD distances between occupancy measures as the number of samples ($n$) and embedding dimensions ($D$) increase, providing theoretical grounding for our approach.</p>
    </div>
  </div>
</section>

<!-- Discovering Diverse Behaviors -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <h2 class="title is-3">Discovering Diverse Behaviors</h2>
    <div class="content">
      <p>We evaluated AutoQD against five baseline methods across six continuous control environments using three metrics: Ground-Truth QD Score (with hand-crafted descriptors), Quality-Weighted Vendi Score (qVS), and Vendi Score (VS) for diversity assessment.</p>
      
      <p>AutoQD consistently outperforms baseline methods in most environments, achieving the highest QD scores in 5 out of 6 tasks. The method successfully discovers diverse, high-performing policies without requiring domain-specific behavioral descriptors.</p>
      
      <p>Additionally, the diverse policy collections discovered by AutoQD show superior adaptability when tested under modified environment dynamics, such as varying friction coefficients and mass scaling, indicating that the automatically discovered behavioral descriptors capture meaningful and robust behavioral variations.</p>
    </div>
  </div>
</section>

<!-- Video Demonstrations -->
<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3">Examples</h2>
      <!-- <p class="has-text-centered">AutoQD automatically discovers diverse locomotion strategies without hand-crafted behavioral descriptors.</p> -->
      
      <!-- Bipedal Walker Videos -->
      <h3 class="title is-4">Bipedal Walker</h3>
      <div class="columns">
        <div class="column">
          <video controls width="100%">
            <source src="static/videos/bipedal0.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <p class="has-text-centered">Smooth movement</p>
        </div>
        <div class="column">
          <video controls width="100%">
            <source src="static/videos/bipedal6.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <p class="has-text-centered">Low crawling</p>
        </div>
        <div class="column">
          <video controls width="100%">
            <source src="static/videos/bipedal9.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <p class="has-text-centered">Stiff-leg walking</p>
        </div>
      </div>

      <!-- Swimmer Videos -->
      <h3 class="title is-4">Swimmer</h3>
      <div class="columns">
        <div class="column">
          <video controls width="100%">
            <source src="static/videos/swimmer0.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <p class="has-text-centered">Smooth motion</p>
        </div>
        <div class="column">
          <video controls width="100%">
            <source src="static/videos/swimmer2.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <p class="has-text-centered">Tail wiggling</p>
        </div>
        <div class="column">
          <video controls width="100%">
            <source src="static/videos/swimmer6.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <p class="has-text-centered">Burst movement</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Citation -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{hedayatian2024autoqd,
  title={AutoQD: Automatic Discovery of Diverse Behaviors with Quality-Diversity Optimization},
  author={Hedayatian, Saeed and Nikolaidis, Stefanos},
  journal={arXiv preprint arXiv:XXXX.XXXXX},
  year={2024}
}</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
